---
title: "Assignment 3"
author: "Rob Tomkies, 300588353"
date: "2022-09-18"
output: 
  pdf_document: 
    latex_engine: xelatex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
pacman::p_load(Rcpp, sloop)

f1 <- function(x, a=0) {
  # square each of the elements of x after subtracting scalar a
  return((x-a)^2)
}

f2 <- function(x,a=c(0,0)) {
  # distance of x from the the point a in the 2D plane
  return(sqrt((x[1]-a[1])^2 + (x[2]-a[2])^2))
}
```


# Question 1

Write R code to find the minimum value of the function f1() in the interval âˆ’100<x<100 when a=4 using optimize(). Show the R code and output.

```{r}
xmin <- stats::optimize(f1, c(-100,100), a = 4) 
print(xmin)
```
Therefore minimum is at x = 4 where output is 0

# Question 2

Write R code to find the minimum value of the function f2() when a=(1,2) using optim(). Use x=c(0,0) as a starting guess. Show the R code and output.

```{r}
x2min <- stats::optim(c(0,0), f2, a = c(1,2)) 
print(x2min)
```
The function found that it could find an almost 0 distance if it selected the exact point of (1,2) after 113 iterations. While the distance is not exactly 0 it effectively is.

# Question 3

```{r}
koptim <- function(par, fn, ..., control = list(fnscale = 1)){
  if(length(par)==1){
    max_trigger <- ifelse(control$fnscale == -1, T,
                          ifelse(control$fnscale == 1, F,
                                 stop('fnscale value 1 for minimum and -1 for maximum')))
    trigger <- F
    increase_distance <- 5
    increase_counter <- 0
    while(trigger == F){
      if(increase_counter >= 10){stop(paste('No max/min found within +/- ',
                                            5^10,
                                            ' of estimate, please consider search start and max/min choice'))}
      xmina <- stats::optimize(fn, c(par-increase_distance,
                                     par+increase_distance),
                               ...,
                               maximum = max_trigger )
      xminb <- stats::optimize(fn, c(par-(5*increase_distance),
                                     par+(5*increase_distance)),
                               ...,
                               maximum = max_trigger)
      
      if(any(is.null(c(xmina$minimum, xminb$minimum))) & increase_counter < 10){
        increase_distance <- 5 * increase_distance
        increase_counter <-  increase_counter + 1
        }
      else if(xmina$minimum != xminb$minimum & increase_counter < 10){
        increase_distance <- 5 * increase_distance
        increase_counter <- increase_counter + 1
      } else{
        
        trigger <- T
        outputs<- list(par = c(xmina$minimum),
                       value = c(xmina$objective))
      }
    }
  }
  else if(length(par)>1){
    xmin <- stats::optim(par = par, fn = fn, control = control, ...)
    outputs<- list(par = c(xmin$par),
                       value = c(xmin$value))
  }
  
  
  return(outputs)
}

```


# Question 4


```{r}
koptim(c(0),f1, a = c(4))
```
```{r}
koptim(c(0,0),f2, a = c(1,2))
```




